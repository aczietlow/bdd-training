<!doctype html>
<html>
	<head>
		<meta charset="utf-8">

		<title>Mindgrub - BDD Training</title>

		<meta name="description" content="Mindgrub BDD Training">
		<meta name="author" content="Chris Zietlow">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/mindgrub.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>
	<body>
		<div class="reveal">
			<div class='footer'>
				<img src="assets/mindgrub-logo.png"/>
				<a href="https://www.drupal.org/u/aczietlow">Chris Zietlow</a>
				<a href="http://aczietlow.github.io/behat/">BDD Training</a>
				<a href="https://twitter.com/aczietlow">@aczietlow</a>
			</div>
			<div class="slides">
				<section>
					<section>
						<h2>Behavior Driven Development</h2>
						<!--<h5>PredictionIO and Drupal</h5>-->
					</section>
					<section>
						<!-- TODO: Find a better picture-->
						<img data-src="assets/chris_z.jpg" alt="Mug shot of Chris Z" />
						<h2><a href="https://twitter.com/aczietlow">@aczietlow</a></h2>
						<span>Lead Software Engineer, <a href="https://www.mindgrub.com">Mindgrub</a></span>
					</section>
				</section>
				<section>
					<h2>A tale of 2 parts</h2>
					<ul>
						<li class="fragment">BDD</li>
						<li class="fragment">Behat/Behave</li>
						<ul>
							<li class="fragment">This is the technical part</li>
							<li class="fragment">Feel free to run away</li>
						</ul>
					</ul>
				</section>
				<section>
					<section>
						<h2>Behavior Driven Development</h2>
						<p class="fragment">Behavior-driven development is an "outside-in" methodology. It starts at the outside by identifying business outcomes, and then drills down into the feature set that will achieve those outcomes. - Dan North*
						</p>
						<p class="fragment">^^ literally wrote the book</p>
						<aside class="notes">Define system behaviors by examples</aside>
					</section>
					<section>
						<h2>Examples of Examples</h2>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
Given Jane bought a laptop
And the laptop cost $500
When Jane returns the laptop
Then she should have $500
					</code></pre>
						<aside class="notes">* Declarative language * We're defining the problem that is solve, not the solution</aside>
					</section>
					<section>
						<h2>What is it good for</h2>
						<ul>
							<li class="fragment">Verifies software features fulfill actually requirements</li>
							<li class="fragment">Provides human readable requirements to describe a feature and how it should work</li>
							<li class="fragment">A blending of functional testing and acceptance testing</li>

						</ul>
					</section>
					<section>
						<h2>Why Bother</h2>
						<p class="fragment">Better understanding of your product</p>
						<img class="fragment" data-src="https://cdn-images-1.medium.com/max/1600/0*Ak-hWgbRp2RSD8iM.png" alt="confused">
						<aside class="notes">
							<dl>
								<dt>understanding</dt>
								<dd>Tests help you really understand the design of the code you are working on. Instead of writing code to do something, you are starting by outlining all the conditions you are subjecting the code to and what outputs you'd expect from that.</dd>
							</dl>
						</aside>
					</section>
					<section>
						<h2>Why bother</h2>
						<ul>
							<li class="fragment">Better acceptance criteria</li>
							<li class="fragment">Less regression</li>
							<li class="fragment">Quality</li>
						</ul>
						<aside class="notes">
								<dt>AC 1</dt>
								<dd>Testing demands that requirements are clearly defined in order to know what test against.</dd>
								<dt>AC 2</dt>
								<dd>Not only does this give you a better grasp of what the client is asking to build, but also gives you the confidence to say when you’ve implemented a feature that satisfies the AC. It’s the only reliable way you can tell a client that a task is “done”.</dd>
								<dt>regression</dt>
								<dd>Avoid tomorrow’s headaches and maintenance. Testing gives you the confidence that when building a new feature, it does not break your existing code base.</dd>
							</dl>
						</aside>
					</section>
					<section>
						<h2>Examples</h2>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
Given a context
When some event happens
Then something *should* occur
						</code></pre>
					</section>
				</section>
				<section>
					<section>

							<h2>How to do the thing?</h2>
						<pre class="fragment"><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
# Comment
@tag
Feature: Eating too many cucumbers may not be good for you

  Eating too much of anything may not be good for you.

  Scenario: Eating a few is no problem
    Given Alice is hungry
	And she likes vegetables
    When she eats 3 cucumbers
    Then she will be full
					</code></pre>
							<!--<img class="fragment" data-src="https://media.giphy.com/media/12XMGIWtrHBl5e/giphy.gif" alt="Run away!!" />-->
							<aside class="notes">Going off in a corner and writing scenarios is not bdd. There's more to it.</aside>

						* more of an analysis technique than a testing technique
					</section>
					<section>
						<h2>How to do the thing?</h2>
						<ol>
							<li class="fragment">Have a conversation</li>
							<li class="fragment">Capture the conversation</li>
							<li class="fragment">Automate the conversation</li>
						</ol>
					</section>
					<section>
						<h2>The conversation</h2>
						<ul>
							<li class="fragment">Is there any context where this scenario won't be true</li>
							<li class="fragment">Are there other outcomes we care about?</li>
							<li class="fragment">Ask for examples</li>
						</ul>
					<aside class="notes">eg #3 If a user goes to a bank teller and ask for $20 then receives $20. Are there other outcomes we care about?</aside>
					</section>
					<section>
						<img data-src="assets/facebook.png" alt="facebook" />
					</section>
					<section>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
Given Jon Snow wants to sign up for facebook
When he enters his first name
And he enters his last name
And he enters his email address
And he re-enters his email address
And he enter a new password
And specifies a gender
And enters his birthday
And submits his request
Then a Facebook account is created
And account name is set as Jon's email address
And a confirmation email is sent to Jon
						</code></pre>
					</section>
				</section>
				<section>
					<h2>Tooling</h2>
					<img class="fragment" data-src="https://media.giphy.com/media/3o7ZetIsjtbkgNE1I4/giphy.gif" alt="Run away!!" />
					<p class="fragment">(You can leave now)</p>
				</section>
				<section>
					<h2>BDD Frameworks</h2>
					<ul>
						<li>Behat - PHP</li>
						<li>Behave - Python</li>
						<li>JBehave - Java</li>
						<li>Cucumber - Java</li>
						<li>Cucumber.js - Javascript</li>
					</ul>
				</section>
				<section>
					<section>
						<h2>Behat</h2>
						<h4 class="fragment">Installation</h4>
						<p class="fragment">composer.json</p>
						<pre><code class="json fragment" data-trim contenteditable style="font-size: 18px;">
	"require": {
	"behat/behat": "^3.0",
	}
						</code></pre>
						<p class="json fragment">a yaml config file</p>
						<pre><code class="yaml fragment" data-trim contenteditable style="font-size: 18px;">
		default:
		suites:
			default:
				contexts:
					- FeatureContext
					- Drupal\DrupalExtension\Context\DrupalContext
		extensions:
		Behat\MinkExtension:
						</code></pre>
						<a href="#">Use your google powers</a>
					</section>
					<section>
						<h2>Toolchain</h2>
						<ul>
							<li class="fragment">Browser (use chrome)</li>
							<li class="fragment">Drivers - Controlling the browser</li>
							<ul>
								<li class="fragment">Emulators - Glorified http clients</li>
								<li class="fragment">Controllers - controls real browser</li>
							</ul>
							<li class="fragment">Mink - Abstraction layer that sits on top of drivers</li>
							<li class="fragment">Behat - scenario step definitions to executable code</li>
						</ul>
					</section>
				</section>
				<section>
					<section>
						<h2>Define Features</h2>
						<img src="assets/file-structure.png" height="300"/>
						<p>Tests are saved in .feature files</p>
					</section>
					<section>
						<h2>User Login</h2>
						<h4>Client Requirement</h4>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
I want to be able to log into my website in order to edit my content.
        </code></pre>
					</section>
					<section>
						<h2>User Login</h2>
						<h4>Requirements we can use</h4>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
As a an anonymous user,
I want to be able to log into my website,
So that I can edit my content.
</code></pre>
						<aside class="notes">
							3 lines that describe the role, the feature, and the benefit
						</aside>
					</section>
					<section>
						<h2>User Login</h2>
						<h4>Acceptance Criteria</h4>
						<p>What does it mean to be logged in? How do we know that we are logged in?</p>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
Given I am an anonymous user
When I am at "user/login"
And I fill in "name" with "admin"
And I fill in "pass" with "admin"
And press "Log in"
Then I should see the link "Log out"
</code></pre>
						<aside class="notes">
							Given [some context]
							When [some event]
							Then [outcome]
						</aside>
					</section>
					<section>
						<h2>User Login</h2>
						<h4>Acceptance Criteria</h4>
						<p>How do we check can edit content. </p>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
Given I am logged in as a user with the administrator role
When I am at "node/add/page"
Then I should see "Create Basic page"
And I should get a 200 HTTP response
</code></pre>
					</section>
					<section>
						<h2>User Login</h2>
						<p>Slap it in a feature file and boom you have your test.</p>
						<pre><code class="gherkin" data-trim contenteditable style="font-size: 18px;">
#./features/user_login.feature
@api
Feature: User Login.
  As a an anonymous user,
  I want to be able to log into my website,
  So that I can edit my content.

Scenario: I can log in.
  Given I am an anonymous user
  When I am at "user/login"
  And I fill in "name" with "admin"
  And I fill in "pass" with "admin"
  And press "Log in"
  Then I should see the link "Log out"

Scenario: I can edit content
  Given I am logged in as a user with the administrator role
  When I am at "node/add/page"
  Then I should see "Create Basic page"
  And I should get a 200 HTTP response
</code></pre>
						<aside class="notes">
							<ul>
								<li>Top Section: Describe the feature. Provides human context </li>
								<li>Each feature is described by multiple scenarios - How the feature should act under certain conditions</li>
								<li>Each of the scenario lines map to function that defines what actions to take.</li>
							</ul>
						</aside>
					</section>
					<section>
						<h2>Executing tests</h2>
						<pre><code data-trim contenteditable>
$ bin/behat features/user_login.feature
</code></pre>
						<img src="assets/user-login-results.png" />
					</section>
					<section>
						<h2>The Glue</h2>
						<pre><code class="php" data-trim contenteditable style="font-size: 18px;">
  /**
   * @Given I am an anonymous user
   * @Given I am not logged in
   */
  public function assertAnonymousUser() {
    // Verify the user is logged out.
    if ($this->loggedIn()) {
      $this->logout();
    }
  }

  /**
   * Logs the current user out.
   */
  public function logout() {
    $this->getSession()->visit($this->locatePath('/user/logout'));
    $this->getUserManager()->setCurrentUser(FALSE);
  }
						</code></pre>
					</section>
				</section>

				<section>
					<h2>Useful Resources</h2>
					<ul>
						<li><a href="https://github.com/aczietlow/umami-behat">Umami Docksal demo</a></li>
						<li><a href="https://behat-drupal-extension.readthedocs.io/en/3.1/">Drupal Behat Extension</a></li>
						<li><a href="http://docs.behat.org/en/latest/">Behat Documentation</a></li>
						<li><a href="http://mink.behat.org/en/latest/">Mink Documentation</a></li>
						<li><a href="https://dannorth.net/introducing-bdd/">Dan North</a></li>
						<li><a href="https://lizkeogh.com/behaviour-driven-development/">Liz Keogh</a></li>
					</ul>
				</section>
				<section>
					<h2>Fin</h2>
					<p class="fragment">Question?</p>
				</section>
			</div>
		</div>
		<!-- Because I'm a scrub and still use jquery. -->
		<script src="lib/js/jquery-3.3.1.min.js"></script>

		<!-- Custom slide configuration. -->
		<script src="js/mindgrub.js"></script>

		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true },
					{ src: 'plugin/search/search.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>
		<script>
			// Displayed upon load, hides when slide changes.
			Reveal.addEventListener('slidechanged', function(event) {
				document.querySelector('.reveal .footer').style.display = 'none';
			});
		</script>
	</body>
</html>
